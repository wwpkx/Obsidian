## 安装ARM交叉编译工具
	sudo apt-get install gcc-arm-linux-gnueabi

## 安装qemu
	sudo apt-get install qemu

## 编译内核和设备树
	$ export ARCH=arm
	$ export CROSS_COMPILE=arm-linux-gnueabi-
	$ make vexpress_defconfig  // ./arch/arm/configs/vexpress_defconfig
	$ make menuconfig             // 编译后生成.config文件
	$ make zImage -j6   // arch/arm/boot/zImage（多线程编译，6个线程）
	$ make modules -j4  // drivers/video/backlight/*.ko
	$ make dtbs  // arch/arm/boot/dts/vexpress-v2p-ca9.dtb
	$ qemu-system-arm -M vexpress-a9 -m 512M -kernel arch/arm/boot/zImage -dtb arch/arm/boot/dts/vexpress-v2p-ca9.dtb -nographic -append "console=ttyAMA0"
	// 该命令指定了开发板类别、内存大小、内核zImage文件、设备树dtb文件、无图形界面、串口
	// 由于还未挂载根文件系统，所以VFS会有报错
	// —[ end Kernel panic - not syncing: VFS: Unable to mount root fs on unknown-block(0,0) ]
	$ ps -a|grep qemu
	$ kill 2590 //kill qemu进程

## busybox根文件系统制作
	https://busybox.net/downloads/
	$ tar xvf busybox-1.32.0.tar.bz2
	$ cd busybox-1.32.0/
	// 配置Makefile。vim Makefile 或者 直接导出
	$ export ARCH=arm
	$ export CROSS_COMPILE=arm-linux-gnueabi-
	$ make menuconfig  //make defconfig
	// 找到Build Options，点y键将选项Build static binary（编译成静态）选中
	$ make -j4
	$ make install  //生成_install文件夹，包含了各种shell命令

## 开始制作根文件系统
	$ cd ~; mkdir rootfs; cd rootfs/
	$ cp -r /home/zvcv/Downloads/busybox-1.32.0/_install/* ./  //拷贝_install目录里的所有文件
	$ mkdir lib
	$ cp -r /usr/arm-linux-gnueabi/lib/* lib/  //将arm交叉编译器的库复制过来
	$ mkdir dev; cd dev/
	$ sudo mknod -m 666 tty1 c 4 1    //创建了一个串口字符设备，主设备号为4，从设备号为1
	$ sudo mknod -m 666 console c 5 1 //创建控制台
	$ sudo mknod -m 666 null c 1 3    //创建null

## 生成虚拟SD卡，制作系统镜像rootfs.ext3(块设备不能直接读写，需要mount)
	$ cd ~; 
	$ dd if=/dev/zero of=rootfs.ext3 bs=1M count=32 //生成虚拟sd卡，rootfs.ext3
	$ mkfs.ext3 rootfs.ext3                         //格式化该镜像
	$ mount -t ext3 rootfs.ext3 /mnt -o loop        //将虚拟sd卡挂载到/mnt
	$ cp -r /home/zvcv/rootfs/* /mnt/               //拷贝rootfs的所有文件到sd卡
	$ umount /mnt                                   //卸载sd

## 使用qemu运行内核和文件系统
	$ cd linux-4.4.232
	// 非图形化启动，比之前多指定了一个sd镜像
	$ qemu-system-arm -M vexpress-a9 -m 512M -kernel arch/arm/boot/zImage -dtb arch/arm/boot/dts/vexpress-v2p-ca9.dtb -nographic -append "root=/dev/mmcblk0 rw console=ttyAMA0" -sd /home/zvcv/rootfs.ext3
	// 图形化启动
	$ qemu-system-arm -M vexpress-a9 -m 512M -kernel arch/arm/boot/zImage -dtb arch/arm/boot/dts/vexpress-v2p-ca9.dtb -append "root=/dev/mmcblk0 rw console=tty0" -sd /home/zvcv/rootfs.ext3
	$ 
